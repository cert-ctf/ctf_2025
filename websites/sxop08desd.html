<html>
	<head>
		<!-- Required meta tags -->
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

		<!-- Bootstrap CSS -->
		<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
		
		<!-- CustomCSS -->
		<link rel="stylesheet" href="./css/custom_blue.css">
		<link rel="stylesheet" href="./css/help.css">

		<title>Mission (K)IMpossible</title>

		<style>
			#binary_container {
				width: 200px; /* Breite des sichtbaren Bereichs */
				overflow: hidden;
				border: 1px solid black; /* Optional: Rahmen um den Bereich */
				font-family: monospace;
				white-space: nowrap;
				position: relative;
			}

			#binary {
				display: inline-block;
				animation: scroll 100s linear infinite;
			}

			@keyframes scroll {
				0% { transform: translateX(0); }
				100% { transform: translateX(-50%); }
			}
    </style>
		
	</head>
	<body>		
		<main class="container" role="main">
			<nav class="navbar navbar-custom" >
				<div>
					<h6>Die Abenteuer von KIM & TIM</h6>
					<h4>Kapt. II – To TI-Mfinity and Beyond</h4>					
				</div>
				
				<img width="15%" src="./img/logo.svg"</img>								
			</nav>
		

			<div class="container" >
				<p><h3>Mond</h3></p>
				<br>
				<div class="card" >
					<div class="card-header" style="text-align: center;">
						<b>Galactic Binary Breach </b>
					</div>
					<h5 class="card-title" style="text-align: justify "></h5>

					<div class="card-body" style="text-align: justify ">
						<p>Der Zaun wird durch ein komplexes binäres Muster geschützt, das kontinuierlich seine Struktur ändert.</p>
						<hr>						
					</div>
							
					<div class="card-body" style="text-align: justify;">	
						<img id="fenceimage" src="work/space_fence.png" class="img-fluid rounded d-block mx-auto" width="50%" alt="">
						<small class="form-text text-muted text-center">Der Zaun besteht aus einem binären Code</small>


						<div id="binary_container" class="d-block mx-auto">
							<div id="binary" class="text-danger">01101101 01100001 01101110 01110101 01100110 01100001 01100011 01110100 01110101 01110010 01100101 01110010 00111101 01000001 01000011 01001101 01000101 00111011 00100000 01110000 01110010 01101111 01100100 01110101 01100011 01110100 00111101 01011010 01100001 01110000 01110000 01101111 01101101 01100001 01110100 01101001 01100011 00100000 01000110 01100101 01101110 01100011 01100101 00101101 01101111 00101101 01001101 01100001 01110100 01101001 01100011 00100000 00110011 00110000 00110000 00110000 00111011 00100000 01101000 01100101 01101001 01100111 01101000 01110100 00111101 00110010 00101110 00110101 01101101 00111011 00100000 01101101 01100001 01110100 01100101 01110010 01101001 01100001 01101100 00111101 01100010 01101001 01101110 01100001 01110010 01111001 00111011 00100000 01100011 01101111 01101100 01101111 01110010 00111101 01100010 01101100 01110101 01100101 00111011 00100000 01100001 01101100 01100001 01110010 01101101 01000101 01101110 01100001 01100010 01101100 01100101 01100100 00111101 01110100 01110010 01110101 01100101 00111011 00100000 01101101 01100001 01101001 01101110 01110100 01100101 01101110 01100001 01101110 01100011 01100101 01000100 01110101 01100101 00111101 00110010 00110000 00110010 00110100 00101101 00110001 00110010 00101101 00110000 00110001 00111011 00100000 01101100 01100001 01110011 01110100 01001001 01101110 01110011 01110000 01100101 01100011 01110100 01101001 01101111 01101110 00111101 00110010 00110000 00110010 00110100 00101101 00110001 00110000 00101101 00110001 00110101 00111011 00100000 01110011 01100101 01101110 01110011 01101111 01110010 01010011 01110100 01100001 01110100 01110101 01110011 00111101 01101111 01110000 01100101 01110010 01100001 01110100 01101001 01101111 01101110 01100001 01101100 00111011 00100000 01110000 01101111 01110111 01100101 01110010 01010011 01110101 01110000 01110000 01101100 01111001 00111101 01110011 01101111 01101100 01100001 01110010 00111011 00100000 01100111 01100001 01110100 01100101 01010011 01110100 01100001 01110100 01110101 01110011 00111101 01100011 01101100 01101111 01110011 01100101 01100100 00111011 00100000 01110111 01100101 01100001 01110100 01101000 01100101 01110010 01010010 01100101 01110011 01101001 01110011 01110100 01100001 01101110 01100011 01100101 00111101 01101000 01101001 01100111 01101000 00111011 00100000 01101001 01101110 01110011 01110100 01100001 01101100 01101100 01100001 01110100 01101001 01101111 01101110 01000100 01100001 01110100 01100101 00111101 00110010 00110000 00110010 00110010 00101101 00110000 00110101 00101101 00110010 00110000 00111011 00100000 01110111 01100001 01110010 01110010 01100001 01101110 01110100 01111001 01010110 01100001 01101100 01101001 01100100 00111101 01110100 01110010 01110101 01100101 0011101101101101 01100001 01101110 01110101 01100110 01100001 01100011 01110100 01110101 01110010 01100101 01110010 00111101 01000001 01000011 01001101 01000101 00111011 00100000 01110000 01110010 01101111 01100100 01110101 01100011 01110100 00111101 01011010 01100001 01110000 01110000 01101111 01101101 01100001 01110100 01101001 01100011 00100000 01000110 01100101 01101110 01100011 01100101 00101101 01101111 00101101 01001101 01100001 01110100 01101001 01100011 00100000 00110011 00110000 00110000 00110000 00111011 00100000 01101000 01100101 01101001 01100111 01101000 01110100 00111101 00110010 00101110 00110101 01101101 00111011 00100000 01101101 01100001 01110100 01100101 01110010 01101001 01100001 01101100 00111101 01100010 01101001 01101110 01100001 01110010 01111001 00111011 00100000 01100011 01101111 01101100 01101111 01110010 00111101 01100010 01101100 01110101 01100101 00111011 00100000 01100001 01101100 01100001 01110010 01101101 01000101 01101110 01100001 01100010 01101100 01100101 01100100 00111101 01110100 01110010 01110101 01100101 00111011 00100000 01101101 01100001 01101001 01101110 01110100 01100101 01101110 01100001 01101110 01100011 01100101 01000100 01110101 01100101 00111101 00110010 00110000 00110010 00110100 00101101 00110001 00110010 00101101 00110000 00110001 00111011 00100000 01101100 01100001 01110011 01110100 01001001 01101110 01110011 01110000 01100101 01100011 01110100 01101001 01101111 01101110 00111101 00110010 00110000 00110010 00110100 00101101 00110001 00110000 00101101 00110001 00110101 00111011 00100000 01110011 01100101 01101110 01110011 01101111 01110010 01010011 01110100 01100001 01110100 01110101 01110011 00111101 01101111 01110000 01100101 01110010 01100001 01110100 01101001 01101111 01101110 01100001 01101100 00111011 00100000 01110000 01101111 01110111 01100101 01110010 01010011 01110101 01110000 01110000 01101100 01111001 00111101 01110011 01101111 01101100 01100001 01110010 00111011 00100000 01100111 01100001 01110100 01100101 01010011 01110100 01100001 01110100 01110101 01110011 00111101 01100011 01101100 01101111 01110011 01100101 01100100 00111011 00100000 01110111 01100101 01100001 01110100 01101000 01100101 01110010 01010010 01100101 01110011 01101001 01110011 01110100 01100001 01101110 01100011 01100101 00111101 01101000 01101001 01100111 01101000 00111011 00100000 01101001 01101110 01110011 01110100 01100001 01101100 01101100 01100001 01110100 01101001 01101111 01101110 01000100 01100001 01110100 01100101 00111101 00110010 00110000 00110010 00110010 00101101 00110000 00110101 00101101 00110010 00110000 00111011 00100000 01110111 01100001 01110010 01110010 01100001 01101110 01110100 01111001 01010110 01100001 01101100 01101001 01100100 00111101 01110100 01110010 01110101 01100101 00111011</div>
						</div>	

						<br><a href="work/binary.dat" download target="_blank"><button id="copyButton" class="btn btn-primary d-block mx-auto">Capture Stream</button></a>
						<br>
						<div class="d-flex justify-content-center">
							<input id="injectText" type="text" class="form-control" placeholder="insert injection" style="width: 200px;">
							<button id="injectButton" class="btn btn-danger ml-2">Inject Code</button>
							<br>
							
						</div>
						<small id="checksumResult" class="form-text text-muted text-center" style="display:block">Status: active</small>
						<hr>
					</div>
					
					
					
					<div id="info_text" style="display: block;">
						<div class="col-md-12" style="align-items: center; justify-content: center; display:flex; text-align: center;">							
							<img width="6%" src="./img/tim_head.png" style="padding-right: 10px;" draggable="false"  oncontextmenu="return false;"></img>		
							<div class="border p-3 rounded " style="border: 1px dashed #1C1A54!important;">							
								<p id="info_text_field" class="bottom_text" style="padding-left: 30px; padding-right: 30px;">Entschlüssele das Muster des binären Zauns und injiziere ein verändertes Muster, um ihn lahmzulegen.</p>
							</div>
							<img width="6%" src="./img/tim_head.png" style="padding-left: 10px;" draggable="false" oncontextmenu="return false;"></img>		
						</div>
						<br>
					</div>
				</div>
				<br>

			</div>
		</main>

		<!-- Hilfe-Button -->
		<button id="helpButton">
			<img src="./img/help.svg" alt="Hilfe" />
		</button>

		<!-- Eingebettetes Hilfefenster -->
		<div id="helpOverlay">
			<button class="close-btn">&times;</button>
			<img src="./img/help.png" alt="Hilfegrafik">
			<p></p>
			<p class="text-justify">Eine Injektion sollte in dem Format erfolgen, in welcher der Code bereitgestellt wird. <i>Ändere nur einen Parameter um unauffällig zu bleiben!</i>
		</p>
		
		</div>

		<script>
			const code = "01101101 01100001 01101110 01110101 01100110 01100001 01100011 01110100 01110101 01110010 01100101 01110010 00111101 01000001 01000011 01001101 01000101 00111011 00100000 01110000 01110010 01101111 01100100 01110101 01100011 01110100 00111101 01011010 01100001 01110000 01110000 01101111 01101101 01100001 01110100 01101001 01100011 00100000 01000110 01100101 01101110 01100011 01100101 00101101 01101111 00101101 01001101 01100001 01110100 01101001 01100011 00100000 00110011 00110000 00110000 00110000 00111011 00100000 01101000 01100101 01101001 01100111 01101000 01110100 00111101 00110010 00101110 00110101 01101101 00111011 00100000 01101101 01100001 01110100 01100101 01110010 01101001 01100001 01101100 00111101 01100010 01101001 01101110 01100001 01110010 01111001 00111011 00100000 01100011 01101111 01101100 01101111 01110010 00111101 01100010 01101100 01110101 01100101 00111011 00100000 01100001 01101100 01100001 01110010 01101101 01000101 01101110 01100001 01100010 01101100 01100101 01100100 00111101 01110100 01110010 01110101 01100101 00111011 00100000 01101101 01100001 01101001 01101110 01110100 01100101 01101110 01100001 01101110 01100011 01100101 01000100 01110101 01100101 00111101 00110010 00110000 00110010 00110100 00101101 00110001 00110010 00101101 00110000 00110001 00111011 00100000 01101100 01100001 01110011 01110100 01001001 01101110 01110011 01110000 01100101 01100011 01110100 01101001 01101111 01101110 00111101 00110010 00110000 00110010 00110100 00101101 00110001 00110000 00101101 00110001 00110101 00111011 00100000 01110011 01100101 01101110 01110011 01101111 01110010 01010011 01110100 01100001 01110100 01110101 01110011 00111101 01101111 01110000 01100101 01110010 01100001 01110100 01101001 01101111 01101110 01100001 01101100 00111011 00100000 01110000 01101111 01110111 01100101 01110010 01010011 01110101 01110000 01110000 01101100 01111001 00111101 01110011 01101111 01101100 01100001 01110010 00111011 00100000 01100111 01100001 01110100 01100101 01010011 01110100 01100001 01110100 01110101 01110011 00111101 01100011 01101100 01101111 01110011 01100101 01100100 00111011 00100000 01110111 01100101 01100001 01110100 01101000 01100101 01110010 01010010 01100101 01110011 01101001 01110011 01110100 01100001 01101110 01100011 01100101 00111101 01101000 01101001 01100111 01101000 00111011 00100000 01101001 01101110 01110011 01110100 01100001 01101100 01101100 01100001 01110100 01101001 01101111 01101110 01000100 01100001 01110100 01100101 00111101 00110010 00110000 00110010 00110010 00101101 00110000 00110101 00101101 00110010 00110000 00111011 00100000 01110111 01100001 01110010 01110010 01100001 01101110 01110100 01111001 01010110 01100001 01101100 01101001 01100100 00111101 01110100 01110010 01110101 01100101 00111011"
			const check = 673320;
			const output = "1067";

			function calculateChecksum(input) {
				let checksum = 0;
				for (let i = 0; i < input.length; i++) {
					checksum += input.charCodeAt(i);
				}
				return checksum;
			}

			function decrypt(input) {
				return input.replace(/[a-zA-Z0-9]/g, function(char) {
					if (char >= 'a' && char <= 'z') {
						return String.fromCharCode((char.charCodeAt(0) - 97 + 13) % 26 + 97);
					} else if (char >= 'A' && char <= 'Z') {
						return String.fromCharCode((char.charCodeAt(0) - 65 + 13) % 26 + 65);
					} else if (char >= '0' && char <= '9') {
						return String.fromCharCode((char.charCodeAt(0) - 48 + 5) % 10 + 48);
					}
					return char;
				});
			}

			function rotateNumbers(str, rotation) {
				return str.replace(/\d/g, function(digit) {
					return (parseInt(digit) + rotation) % 10;
				});
			}

			function decodeWithRotation(encodedImage, numberRotation) {
				return rotateNumbers(encodedImage, 10 - numberRotation);
			}

			document.getElementById('injectButton').addEventListener('click', function() {
				const inputText = document.getElementById('injectText').value;
				const checksum = calculateChecksum(inputText);

				console.log(decrypt(check.toString()))
				console.log(checksum)

				if (checksum === parseInt(decrypt(check.toString()))) {
					document.getElementById('checksumResult').textContent = 'code injected';
					document.getElementById('binary').classList.remove("text-danger");
					document.getElementById('binary').classList.add("text-success");	
					document.getElementById('info_text_field').textContent = "Verwende diesen Code für das Tor: "+decrypt(output);
					document.getElementById('fenceimage').src = "work/space_fence2.png";
								
				} else {
					document.getElementById('checksumResult').textContent = 'code rejected';
					document.getElementById('injectText').value = "";
					document.getElementById('binary').classList.remove("text-success");
					document.getElementById('binary').classList.add("text-danger");					
				}
        	});
		</script>
		
		 <!-- Bootstrap JS and dependencies -->
		 <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
		 <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
		 <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
		 <script src="./js/help.js"></script>
	 </body>
			
	</body>
</html>
